# 🎨 Frontend 연동 완료 가이드

## ✅ 연동 완료 사항

### 1. **API 연결 업데이트**
- `frontend/src/utils/api.ts` 전면 개편
- 새로운 통합 API 서버(`api_server.py`)와 연결
- OpenAI 호환 형식으로 요청/응답 처리
- 스마트 라우팅 지원 (일반 대화 vs 데이터 분석)

### 2. **스트리밍 개선**
- 실시간 콘텐츠 스트리밍 지원
- 질문 유형별 다른 처리 방식
- 오류 처리 개선

### 3. **UI/UX 업데이트**
- 환영 메시지 개선 (일반 대화 + 데이터 분석 안내)
- 질문 예시 업데이트
- 메타데이터 및 타이틀 변경

### 4. **타입 안전성**
- TypeScript 에러 모두 수정
- 새로운 API 응답 형식에 맞는 타입 정의

## 🚀 실행 방법

### 1. 시스템 전체 실행
```bash
# 루트 디렉토리에서
python start_system.py

# 자동으로 다음이 실행됩니다:
# - API 서버 (포트 8000)
# - Frontend 서버 (포트 3000)
```

### 2. 개별 실행
```bash
# API 서버만
python api_server.py

# Frontend만
cd frontend
npm run dev
```

## 💡 사용자 경험

### 일반 대화 예시
```
👤: 안녕하세요!
🤖: 안녕하세요! 반갑습니다 😊 무엇을 도와드릴까요?

👤: 오늘 몇 시야?
🤖: 현재 시각은 2024년 12월 15일 오후 3시 45분입니다 ⏰

👤: 파이썬 코드 작성 도와줘
🤖: 어떤 파이썬 코드를 작성하고 싶으신가요? 구체적으로 설명해주시면...
```

### 데이터 분석 예시
```
👤: 한국의 인구 통계를 보여줘
🤖: 📊 KOSIS 데이터를 조회하고 있습니다...
    [MCP 도구를 통한 실제 데이터 조회 및 분석]

👤: GDP 성장률 분석해줘
🤖: 📈 경제 지표를 분석하겠습니다...
    [경제 데이터 분석 및 인사이트 제공]
```

## 🔧 주요 기능

### 1. **스마트 라우팅**
Frontend에서 질문 유형을 미리 분석하여 적절한 아이콘과 상태 표시:
- 💬 일반 대화: OpenAI GPT 직접 처리
- 📊 데이터 분석: MCP 도구 사용

### 2. **실시간 스트리밍**
- 응답이 실시간으로 화면에 표시
- 타이핑 효과로 자연스러운 대화감
- 오류 발생 시 즉시 표시

### 3. **향상된 오류 처리**
- API 키 미설정 시 친절한 안내
- 네트워크 오류 시 재시도 옵션
- 서버 상태 실시간 모니터링

### 4. **반응형 UI**
- 모바일/태블릿/데스크톱 최적화
- 다크모드 지원
- 접근성 개선

## 📊 기술 스택

### Backend (api_server.py)
- **FastAPI**: 고성능 비동기 웹 프레임워크
- **OpenAI API**: 일반 대화 처리
- **MCP Client**: 데이터 분석 도구 연동
- **스마트 라우팅**: 질문 유형 자동 감지

### Frontend
- **Next.js 14**: React 기반 풀스택 프레임워크
- **TypeScript**: 타입 안전성
- **Tailwind CSS**: 유틸리티 우선 스타일링
- **Zustand**: 상태 관리
- **Chart.js**: 데이터 시각화

## 🔗 API 연동 세부 사항

### 1. **요청 형식**
```typescript
// OpenAI 호환 형식
{
  "model": "gpt-3.5-turbo",
  "messages": [
    {"role": "user", "content": "질문"}
  ],
  "stream": true  // 스트리밍 사용 시
}
```

### 2. **응답 처리**
```typescript
// 일반 응답
{
  "choices": [
    {
      "message": {
        "content": "응답 내용"
      }
    }
  ]
}

// 스트리밍 응답
data: {"content": "실시간 텍스트 조각"}
data: [DONE]
```

### 3. **질문 유형 감지**
Frontend에서 미리 감지하는 키워드들:
```typescript
// 데이터 분석 키워드
['통계', '데이터', '분석', 'GDP', '인구', 'KOSIS']

// 일반 대화 키워드  
['안녕', '시간', '날짜', '도움', '설명']
```

## 🔍 디버깅 가이드

### 1. **연결 문제**
```bash
# API 서버 상태 확인
curl http://localhost:8000/health

# Frontend 로그 확인
# 브라우저 개발자 도구 → Console 탭
```

### 2. **스트리밍 문제**
- 브라우저 Network 탭에서 WebSocket 연결 확인
- Console에서 "🔄 스트리밍 업데이트" 로그 확인

### 3. **API 키 문제**
- .env 파일에 OPENAI_API_KEY 설정 확인
- 서버 재시작 후 테스트

## 🎯 다음 단계

### 추가 개발 가능 기능
1. **사용자 인증** - 로그인/회원가입
2. **대화 히스토리** - 이전 대화 저장/불러오기
3. **파일 업로드** - CSV, Excel 파일 분석
4. **더 많은 MCP 서버** - 다양한 데이터 소스 연동
5. **고급 시각화** - D3.js를 활용한 인터랙티브 차트

### 성능 최적화
1. **응답 캐싱** - 자주 요청되는 데이터 캐시
2. **레이지 로딩** - 컴포넌트 지연 로딩
3. **번들 최적화** - 불필요한 패키지 제거

---

✨ **Frontend와 Backend가 완벽하게 연동되었습니다!** 
이제 일반 대화와 데이터 분석을 모두 지원하는 통합 AI Assistant를 사용할 수 있습니다. 